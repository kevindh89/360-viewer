<template name="main">
    <div class="action-container">
        <div class="mdl-textfield mdl-js-textfield mdl-textfield--file">
            <a-scene vr-mode-ui="enabled: false">
                <a-assets>
                    <img id="photo" src="R0010471.JPG"/>
                </a-assets>
                <a-entity position="0 -5 0" rotation="0 90 -60">
                    {{> quickSelector}}
                </a-entity>
                <a-entity id="hud" position="0 1.8 5" camera look-controls>
                    <a-entity id="cursor" cursor="fuse: true; timeout: 0" cursor-listener
                              position="0 0 -5" scale="0.15 0.15 0.15"
                              geometry="primitive: ring"
                              material="color: {{#if client.style.pointerColor}}{{client.style.pointerColor}}{{else}}#e9342d{{/if}}; shader: flat">
                        <a-animation begin="cursor-hovering" easing="ease-in" attribute="scale"
                                     fill="forwards" to="0.05 0.05 0.05" dur="1000"></a-animation>
                    </a-entity>
                    <a class="btn-floating btn-large waves-effect waves-light red lighten-1" id="vrBtn"
                            style="{{#if client.style.backgroundColor}}background-color: {{client.style.backgroundColor}} !important;{{/if}}">
                        <img src="cardboard-white.png" />
                    </a>
                </a-entity>
                <a-sky id="image" src="#photo" rotation="0 0 0"></a-sky>
            </a-scene>

            <script type="text/javascript">
                AFRAME.registerComponent('cursor-listener', {
                    init: function () {
                        this.el.addEventListener('click', function (evt) {
                            const el = evt.detail.intersectedEl;
                            let src = el.getAttribute('material').src.substring(4);
                            src = src.substring(0, src.length - 1);
                            $('#image').attr('src', src);
                        });
                        this.el.addEventListener('mouseleave', function (evt) {
                            // Reset cursor size
                            const cursor = evt.srcElement;
                            cursor.setAttribute('scale', '0.15 0.15 0.15');
                        });
                    }
                });
            </script>
        </div>
    </div>
</template>
